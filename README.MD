
# ğŸ”¥ ForgeAPI Â· Modular API Generator

**Current version:** [![version](https://img.shields.io/badge/version-0.1.0-blue.svg)](https://github.com/neftaliCruzSosa/forgeapi/releases)

**ForgeAPI** is a powerful, modular API code generator designed to help developers quickly scaffold real-world backend applications with built-in authentication, validation, and access control.

---

## âœ¨ Features

- ğŸ” JWT authentication and role-based access control
- ğŸ§± MongoDB and PostgreSQL support
- ğŸ§© Clean, modular hexagonal architecture
- ğŸ›¡ï¸ Entity-level CRUD with per-route access control (`auth`, `admin`, `self`)
- ğŸ“‚ Automatically generates models, controllers, routes, validators, and middlewares
- âš™ï¸ Template-based code generation using EJS
- ğŸ§ª Includes test scripts and seed data for rapid iteration
- ğŸ‘¤ Built-in support for entities like `User`

---

## ğŸš€ Getting Started

1. **Clone the repository**
```bash
git clone https://github.com/neftaliCruzSosa/forgeapi.git
cd forgeapi
```

2. **Install dependencies**
```bash
npm install
```

3. **Run the demo to generate a full example project including test seed data**
```bash
npm run demo
```

4. **Check the generated API**
The generated project will appear under:
```
/projects/<yourProjectName>
```

---

## ğŸ“ Project Structure

```
forgeapi/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ application/           # Core use cases like GenerateApiUseCase
â”‚   â”œâ”€â”€ domain/                # Domain models and logic
â”‚   â”œâ”€â”€ infrastructure/        # Adapters: DB, output, auth
â”‚   â”œâ”€â”€ config/                # Preset configurations
â”‚   â””â”€â”€ templates/             # EJS templates for code generation
â”œâ”€â”€ test/                      # Example use cases and tests
â”œâ”€â”€ projects/                  # Output folder for generated APIs
â””â”€â”€ cli.js                     # CLI entry point (coming soon)
```

---

## ğŸ§ª Full Example Entity Definition

```js
const entities = [
  {
    name: "User",
    builtIn: true,
    skipSystemFields: ["createdBy"],
    overrideFields: [
      { name: "bio", type: "String" },
      { name: "avatar", type: "String" },
    ],
    protect: {
      create: "admin",
      getAll: "admin",
      getById: "admin",
      update: "self",
      delete: "admin",
    },
  },
  {
    name: "Post",
    fields: [
      { name: "title", type: "String", required: true },
      { name: "content", type: "String" },
      { name: "tags", type: "Array" },
    ],
    protect: {
      create: "auth",
      update: "self",
      delete: "self",
      restore: "admin",
      hardDelete: "admin",
    },
  },
  {
    name: "Comment",
    fields: [
      { name: "text", type: "String", required: true },
      { name: "post", type: "ref", ref: "Post", required: true },
    ],
    protect: {
      create: "auth",
      update: "self",
      delete: "self",
      restore: "admin",
      hardDelete: "admin",
    },
  },
  {
    name: "Like",
    fields: [
      { name: "post", type: "ref", ref: "Post", required: true },
      { name: "user", type: "ref", ref: "User", required: true },
    ],
    protect: {
      create: "auth",
      delete: "self",
    },
  },
];
```

---

## ğŸ”’ `protect` Field Explained

Each entity can define access levels for CRUD routes via the `protect` field. Available roles:

- `"admin"` â€“ Only admins can access the route
- `"auth"` â€“ Any authenticated user can access
- `"self"` â€“ Only the user who created the resource can access
- `""` or omitted â€“ Route is public

Supported route-level protections:

- `create`
- `getAll`
- `getById`
- `update`
- `delete`
- `restore` (for soft deletes)
- `hardDelete` (for permanent deletion)

---

## ğŸ”‘ Auth Routes Generated

When `auth: true` is enabled, ForgeAPI generates the following default authentication routes:

- `POST /api/auth/register` â†’ Register a new user  
- `POST /api/auth/login` â†’ Login
- `POST /api/auth/promote` â†’ Promote user roles (e.g., to admin) â€” restricted to admins

These routes are automatically wired with authentication, role-based access control, and input validation.

---

## ğŸ” Routes Generated per Entity

For each defined entity, ForgeAPI generates:

- `POST /api/<entity>` â†’ Create entity
- `GET /api/<entity>` â†’ Get all entities
- `GET /api/<entity>/:id` â†’ Get entity by ID
- `PUT /api/<entity>/:id` â†’ Update entity by ID
- `DELETE /api/<entity>/:id` â†’ Soft delete
- `POST /api/<entity>/:id/restore` â†’ Restore deleted entity
- `DELETE /api/<entity>/:id/hard` â†’ Permanently delete

---

## âš™ï¸ System Fields

ForgeAPI automatically includes the following fields in every entity:

- `isDeleted` (for soft deletes)
- `createdBy` (if authentication is enabled)

You can skip these using `skipSystemFields`.

---

## ğŸ“„ License

MIT Â© 2025 Neftali Cruz Sosa